// SPDX-License-Identifier: GPL-2.0
/*
 * dts file for Xilinx ZynqMP SC k24 RevA
 *
 * (C) Copyright 2020 - 2021, Xilinx, Inc.
 * (C) Copyright 2023 - 2024, Advanced Micro Devices, Inc.
 *
 * Michal Simek <michal.simek@amd.com>
 */

#include <dt-bindings/net/ti-dp83867.h>
#include "zynqmp-sm-k24-revA.dts"

/delete-node/ &optee;
/delete-node/ &eeprom_cc;

/ {
	model = "ZynqMP SC K24 RevA";
	compatible = "xlnx,zynqmp-sc-k24-revA", "xlnx,zynqmp-sc-k24",
		     "xlnx,zynqmp";

	aliases {
		nvmem1 = &eeprom_cc;
	};
};

&gem1 { /* MDIO MIO50/51 */
	status = "okay";
	phy-mode = "sgmii";
	phy-handle = <&phy0>;

	mdio: mdio {
		#address-cells = <1>;
		#size-cells = <0>;

		phy0: ethernet-phy@1 {
			#phy-cells = <1>;
			compatible = "ethernet-phy-id2000.a231";
			reg = <1>;
			ti,dp83867-rxctrl-strap-quirk;
			reset-gpios = <&gpio 77 GPIO_ACTIVE_LOW>;
			reset-assert-us = <2500>;
			reset-deassert-us = <500>;
		};
	};
};

/* i2c via PL */
/* u192 0x10 SLG7XL46528 */
/* u195 0x69 SIT95211 */

&i2c1 {
	status = "okay";
	bootph-all;
	clock-frequency = <400000>;
	pinctrl-names = "default", "gpio";
	pinctrl-0 = <&pinctrl_i2c1_default>;
	pinctrl-1 = <&pinctrl_i2c1_gpio>;
	scl-gpios = <&gpio 24 (GPIO_ACTIVE_HIGH | GPIO_OPEN_DRAIN)>;
	sda-gpios = <&gpio 25 (GPIO_ACTIVE_HIGH | GPIO_OPEN_DRAIN)>;

	eeprom_cc: eeprom@54 { /* on CC defined by spec */
		bootph-all;
		compatible = "atmel,24c64";
		reg = <0x54>;
	};

	/* 0x33 - u167 DA9131 */
	/* 0x32 - u166 DA9130 */
	/* 0x30-0x31 - u170 DA9062 */
	/* 0x70 - u168 SLG7XL44091 */
	/* 0x68 - u169 SLG7XL44092 */
	/* 0x10-0x11 - slg7xl46528 */
};

&gpio {
	status = "okay";
	gpio-line-names = "QSPI_CLK", "QSPI_DQ1", "QSPI_DQ2", "QSPI_DQ3", "QSPI_DQ0", /* 0 - 4 */
			  "QSPI_CS_B", "SPI_CLK", "LED1", "LED2", "SPI_CS_B", /* 5 - 9 */
			  "SPI_MISO", "SPI_MOSI", "FWUEN", "EMMC_DAT0", "EMMC_DAT1", /* 10 - 14 */
			  "EMMC_DAT2", "EMMC_DAT3", "EMMC_DAT4", "EMMC_DAT5", "EMMC_DAT6", /* 15 - 19 */
			  "EMMC_DAT7", "EMMC_CMD", "EMMC_CLK", "EMMC_RST", "I2C1_SCL", /* 20 - 24 */
			  "I2C1_SDA", "", "", "", "", /* 25 - 29 */
			  "", "SHUTDOWN", "", "", "PS_PWR_EN", /* 30 - 34 */
			  "", "UART1_TXD", "UART1_RXD", "DUT_MODE0", "DUT_MODE1", /* 35 - 39 */
			  "DUT_MODE2", "DUT_MODE3", "MODE0_RDBK", "MODE1_RDBK", "MODE2_RDBK", /* 40 - 44 */
			  "MODE3_RDBK", "INIT_DONE", "FAN_PWM", "UART_MUXSEL0", "UART_MUXSEL1", /* 45 - 49 */
			  "MDIO_MDC", "MDIO", "USB_CLK", "USB_DIR", "USB_TXDATA2", /* 50 - 54 */
			  "USB_NXT", "USB_TXDATA0", "USB_TXDATA1", "USB_STP", "USB_TXDATA3", /* 55 - 59 */
			  "USB_TXDATA4", "USB_TXDATA5", "USB_TXDATA6", "USB_TXDATA7", "", /* 60 - 64 */
			  "", "I2C0_SCL", "I2C0_SDA", "I2C0_ALERT", "I2C1_ALERT", /* 65 - 69 */
			  "UART0_RXD", "UART0_TXD", "", "", "I2C_MUX_RST0", /* 70 - 74 */
			  "I2C_MUX_RST1", "USB_PHY_RESET_B", "PS_GEM_RESET", /* 75 - 77, MIO end and EMIO start */
			  "", "", /* 78 - 79 */
			  "", "", "", "", "", /* 80 - 84 */
			  "", "", "", "", "", /* 85 - 89 */
			  "", "", "", "", "", /* 90 - 94 */
			  "", "", "", "", "", /* 95 - 99 */
			  "", "", "", "", "", /* 100 - 104 */
			  "", "", "", "", "", /* 105 - 109 */
			  "", "", "", "", "", /* 110 - 114 */
			  "", "", "", "", "", /* 115 - 119 */
			  "", "", "", "", "", /* 120 - 124 */
			  "", "", "", "", "", /* 125 - 129 */
			  "", "", "", "", "", /* 130 - 134 */
			  "", "", "", "", "", /* 135 - 139 */
			  "", "", "", "", "", /* 140 - 144 */
			  "", "", "", "", "", /* 145 - 149 */
			  "", "", "", "", "", /* 150 - 154 */
			  "", "", "", "", "", /* 155 - 159 */
			  "", "", "", "", "", /* 160 - 164 */
			  "", "", "", "", "", /* 165 - 169 */
			  "", "", "", ""; /* 170 - 173 */
};

&usb0 { /* mio52 - mio63 */
	status = "okay";
	reset-gpios = <&gpio 76 GPIO_ACTIVE_LOW>;
};

&dwc3_0 {
	status = "okay";
	dr_mode = "host";
	snps,usb3_lpm_capable;
	maximum-speed = "super-speed";
};

&pinctrl0 {
	status = "okay";
	pinctrl_i2c1_default: i2c1-default {
		conf {
			groups = "i2c1_6_grp";
			bias-pull-up;
			slew-rate = <SLEW_RATE_SLOW>;
			power-source = <IO_STANDARD_LVCMOS18>;
		};

		mux {
			groups = "i2c1_6_grp";
			function = "i2c1";
		};
	};

	pinctrl_i2c1_gpio: i2c1-gpio-grp {
		conf {
			groups = "gpio0_24_grp", "gpio0_25_grp";
			slew-rate = <SLEW_RATE_SLOW>;
			power-source = <IO_STANDARD_LVCMOS18>;
		};

		mux {
			groups = "gpio0_24_grp", "gpio0_25_grp";
			function = "gpio0";
		};
	};
};
